# This file contains steps for running the public OSS pipeline.  It defines
# steps required by the public build specifically, then includes the pipeline
# file containing common build steps.

# Non-buildkite nodes to re-use:
common_values:
  retry: &retry_on_agent_kill
    automatic: &agent_kill_conditions
      - signal_reason: agent_stop  # spot instance killed by AWS
        limit: 3
      - exit_status: -1            # agent timed out
        signal_reason: none
        limit: 3

steps:
  # TODO: ronh: decide what kind of linting we want in the OSS pipeline
  # - label: ':git: Lint commits'
  #   key: lint-commits
  #   branches: '!refs/heads/main'
  #   commands:
  #     - ./scripts/commit_lint.sh
  #   agents:
  #     queue: t3a-small
  - label: 'Depends on first'
    depends_on: first
    commands:
      - echo 'second'
