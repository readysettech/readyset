version: "3.8"
services:
  zookeeper:
    image: debezium/zookeeper:1.3
    # Uncomment the DBs that you want to use
#    depends_on:
#      - mariadb
#      - postgres
    ports:
      - '2181:2181'
      - '2888:2888'
      - '3888:3888'
    logging:
      driver: none
  kafka:
    image: debezium/kafka:1.3
    links:
      - zookeeper
    environment:
      ZOOKEEPER_CONNECT: zookeeper:2181
    ports:
      - '9092:9092'
    logging:
      driver: none
  kafkaconnect:
    image: debezium/connect:1.3
    links:
      - kafka
      # Uncomment the DBs that you want to use
#      - mariadb
#      - postgres
    environment:
      BOOTSTRAP_SERVERS: kafka:9092
      GROUP_ID: 1
      CONFIG_STORAGE_TOPIC: my_source_connect_configs
      OFFSET_STORAGE_TOPIC: my_source_connect_offsets
      STATUS_STORAGE_TOPIC: my_connect_statuses
    ports:
      - '8083:8083'
    logging:
      driver: none
  kafka-connect-setup:
    build: base-os/.
    depends_on:
      - kafkaconnect
    working_dir: /opt/kafka-connect-setup
    entrypoint: ["/bin/sh", "-c", "./scripts/setup.sh"]
    volumes:
      - ./kafka-connect-setup/scripts:/opt/kafka-connect-setup/scripts:ro
      # Uncomment the DB connectors you want to use
#      - ./kafka-connect-setup/connectors/mariadb:/opt/kafka-connect-setup/connectors/mariadb:ro
#      - ./kafka-connect-setup/connectors/postgres:/opt/kafka-connect-setup/connectors/postgres:ro
#  postgres:
#    image: debezium/postgres:10
#    environment:
#      POSTGRES_USER: root
#      POSTGRES_PASSWORD: debezium
#      POSTGRES_DB: test
#    ports:
#      - '5432:5432'
#    volumes:
#      - ./postgres/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d:ro
#    logging:
#      driver: none
#  mariadb:
#    image: mariadb:10.5
#    environment:
#      MYSQL_ROOT_PASSWORD: debezium
#      MYSQL_DATABASE: test
#    ports:
#      - '3306:3306'
#    volumes:
#      - ./mariadb/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d:ro
#      - ./mariadb/conf.d:/etc/mysql/conf.d:ro
#    logging:
#      driver: none