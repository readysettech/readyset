statement ok
CREATE TABLE json_overlaps_test (id INT PRIMARY KEY, payload JSON);

statement ok
INSERT INTO json_overlaps_test VALUES
  (1, '[1,2,3]'),
  (2, '[3,4]'),
  (3, '[4,5]'),
  (4, '[1,2,3,4]'),
  (5, '[]');

query I
SELECT json_overlaps(payload, '[1,2,3]') FROM json_overlaps_test ORDER BY id;
----
1
1
0
1
0

query I
SELECT id FROM json_overlaps_test
WHERE json_overlaps(payload, '[1,2,3]')
ORDER BY id;
----
1
2
4

query I
SELECT id FROM json_overlaps_test
WHERE id > ? AND json_overlaps(payload, '[1,2,3]')
ORDER BY id;
? = 1
----
2
4

# Test COALESCE and IFNULL as predicates
statement ok
CREATE TABLE bool_nulls (id INT PRIMARY KEY, b BOOLEAN);

statement ok
INSERT INTO bool_nulls VALUES
  (1, TRUE),
  (2, FALSE),
  (3, NULL),
  (4, TRUE),
  (5, NULL);

# Test COALESCE with boolean, defaulting NULL to TRUE
query I
SELECT id FROM bool_nulls WHERE COALESCE(b, TRUE) ORDER BY id;
----
1
3
4
5

# Test COALESCE with boolean, defaulting NULL to FALSE
query I
SELECT id FROM bool_nulls WHERE COALESCE(b, FALSE) ORDER BY id;
----
1
4

# Test IFNULL with boolean, defaulting NULL to TRUE
query I
SELECT id FROM bool_nulls WHERE IFNULL(b, TRUE) ORDER BY id;
----
1
3
4
5

# Test IFNULL with boolean, defaulting NULL to FALSE
query I
SELECT id FROM bool_nulls WHERE IFNULL(b, FALSE) ORDER BY id;
----
1
4
