# Tests for ARRAY[] IN (ARRAY[], ...) expressions (REA-6335).
#
# Verifies that array constructors on the RHS of IN are compared via
# element-wise array equality, not string comparison.

statement ok
create table s (id int, status int);

statement ok
insert into s values
  (1, 0),
  (2, 10),
  (3, 20),
  (4, 10),
  (5, 30),
  (6, 40);

# ARRAY with a column ref IN a single array literal — should match rows with status=10
query I rowsort
select id from s where ARRAY[0, status, 20] IN (ARRAY[0, 10, 20]);
----
2
4

# Same query matching multiple rows (status=10 appears twice)
query I rowsort
select id from s where ARRAY[status] IN (ARRAY[10]);
----
2
4

# NOT IN — should exclude the matching rows
query I rowsort
select id from s where ARRAY[0, status, 20] NOT IN (ARRAY[0, 10, 20]);
----
1
3
5
6

# IN with multiple array candidates on the RHS
query I rowsort
select id from s where ARRAY[status] IN (ARRAY[10], ARRAY[30]);
----
2
4
5

# No match — empty result
query I nosort
select id from s where ARRAY[status] IN (ARRAY[99]);
----

