[package]
name = "noria-dataflow"
version = "0.7.0"
edition = "2018"
authors = ["The Noria developers <noria@pdos.csail.mit.edu>"]
license = "MIT OR Apache-2.0"

description = "Internal noria-server crate"
repository = "https://github.com/mit-pdos/noria.git"
homepage = "https://pdos.csail.mit.edu/noria"

keywords = ["internal"]

[badges]
maintenance = { status = "experimental" }

[dependencies]
anyhow = "1.0"
bincode = "1.0.0"
reader_map = { path = "reader_map" }
hashbag = "0.1.2"
ahash = "0.3"
futures-util = "0.3.13"
lazy_static = "1.0.0"
itertools = "0.9"
metrics = "0.17.0"
nom-sql = { path = "../../../nom-sql" }
indexmap = "1.1.0"
rand = "0.7"
regex = "1"
serde_derive = "1.0.8"
serde_json = "1.0.2"
stream-cancel = "0.8.0"
tracing = { version = "0.1", features = ["release_max_level_info"] }
tokio = { version = "1.8.1", features = ["full"] }
tokio-stream = { version = "0.1.5", features = ["net"] }
vec_map = { version = "0.8.0", features = ["eders"] }
tempfile = "3.0.2"
derive_more = "0.99.11"
tuple = "0.5.1"
vec1 = "1.6.0"
maplit = "1.0.2"
derivative = "2.2.0"
dataflow_expression = { path = "expression" }
criterion = { version = "0.3", features=['real_blackbox'], optional = true }

# need features
petgraph = { version = "0.5", features = ["serde-1"] }
serde = { version = "1.0.8", features = ["rc"] }
timekeeper = { version = "0.3.2", default-features = false }
rocksdb = { git = "https://github.com/rust-rocksdb/rust-rocksdb.git", rev = "a0ad4fdcfea52f0a1b10d019c54c494e3f9488a5", default-features = false, features = ["lz4"] }
# Ideally we would use rocksdb version 0.17, but it creates a build conflict,
# and version 0.16 has a segmentation fault bug when using `multi_get`,
# so we have to use the fix from the commit directly
# https://github.com/rust-rocksdb/rust-rocksdb/commit/a0ad4fdcfea52f0a1b10d019c54c494e3f9488a5
# rocksdb = {version = "0.16", default-features = false, features = ["lz4"] }


# local deps
common = { path = "../common", package = "noria-common" }
noria = { path = "../../noria" }
unbounded-interval-tree = { path = "../../../unbounded-interval-tree" }
launchpad = { path = "../../../launchpad" }
thiserror = "1.0.26"
test-strategy = "0.1.1"

[dev-dependencies]
pretty_assertions = "0.7.2"
proptest = "1.0.0"

[features]
bench = ["criterion"]
