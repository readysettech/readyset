[sources.in]
type = "journald"
include_units = [ "readyset-server", "readyset-mysql-adapter" ]

[transforms.metadata]
type = "remap"
inputs = ["in"]
source = '''
  log_json = parse_json!(.message)
  server_info = { "host": .host, "app": .SYSLOG_IDENTIFIER }
  . = merge!(log_json, server_info)
'''

[sinks.out]
inputs = ["metadata"]
type = "vector"
address = "0.0.0.0:8383"
version = "1"

