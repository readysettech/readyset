steps:
  {{#each modules}}
  - label: ":terraform: Plan for {{ module_descriptor }}"
    plugins:
      - docker#v3.8.0:
          image: "305232526136.dkr.ecr.us-east-2.amazonaws.com/substrate-runtime:${BUILDKITE_COMMIT}"
          propagate-environment: true
          propagate-aws-auth-tokens: true
          command:
            - "{{ buildkite_plan_command }}"
            {{#each module_locator_args}}
            - "{{ this }}"
            {{/each}}
          shell: false
          environment:
          - BUILDKITE_API_TOKEN
      - ecr#v2.2.0:
          account_ids: "305232526136"
          login: true
      - cultureamp/aws-assume-role#v0.2.0:
          role: "arn:aws:iam::716876017850:role/Administrator"
    agents:
      queue: ops
  {{/each}}
